<div class="tab-container mat-typography">

    <h3>KYC Documents</h3>

  <button mat-raised-button class="f-right" color="primary" (click)="setAllExpired()" *mifosxHasPermission="'CREATE_CLIENTIDENTIFIER'">
    <fa-icon icon="sync"></fa-icon>&nbsp;&nbsp; Set All Expired
  </button>

  <table mat-table #identifiersTable [dataSource]="clientIdentities">

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef> ID </th>
          <td mat-cell *matCellDef="let identity">{{identity.id}}</td>
        </ng-container>

        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Type </th>
          <td mat-cell *matCellDef="let identity"> {{identity.documentType.name}}</td>
        </ng-container>

        <ng-container matColumnDef="documents">
          <th mat-header-cell *matHeaderCellDef>Identity Documents </th>
          <td mat-cell *matCellDef="let identity">
            <div *ngFor="let document of identity.documents">
              {{document.name}}
              <fa-icon icon="cloud-download-alt" (click)="download(document.parentEntityId,document.id)" *mifosxHasPermission="'READ_DOCUMENT'"></fa-icon>
            </div>
          </td>
        </ng-container>

      <ng-container matColumnDef="uploadedAt">
        <th mat-header-cell *matHeaderCellDef> Uploaded On </th>
        <td mat-cell *matCellDef="let identity">
          {{documentDate(identity.uploadDate)}}
        </td>
      </ng-container>

      <ng-container matColumnDef="valid">
        <th mat-header-cell *matHeaderCellDef> Valid Until </th>
        <td mat-cell *matCellDef="let identity">
          {{documentDate(identity.expiryDate)}}
        </td>
      </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let identity;  let i = index">
              {{getDocumentStatus(identity.status, i)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let identity; let i = index">
            <button class="identity-action-button" mat-raised-button color="primary" (click)="uploadDocument(i,identity.id)" *mifosxHasPermission="'CREATE_DOCUMENT'">
              <fa-icon icon="cloud-upload-alt"></fa-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="identitiesColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: identitiesColumns;"></tr>

    </table>

</div>
